---
import { Image } from "astro:assets";
import { useTranslations } from "@i18n/utils";
import {
  PiBriefcase,
  PiMapPin,
  PiCalendar,
  PiLightning,
  PiStack,
} from "react-icons/pi";

export interface Props {
  lang: "es" | "en";
}

const { lang } = Astro.props;
const t = useTranslations(lang);

const experiences = [
  {
    id: 1,
    company: t("work.companies.baacc.name"),
    totalPeriod: t("work.companies.baacc.totalPeriod"),
    totalDuration: t("work.companies.baacc.totalDuration"),
    location: t("work.companies.baacc.location"),
    workMode: t("work.companies.baacc.workMode"),
    logo: "/assets/company/baacc.webp",
    roles: [
      {
        title: t("work.companies.baacc.roles.architect.title"),
        period: t("work.companies.baacc.roles.architect.period"),
        duration: t("work.companies.baacc.roles.architect.duration"),
        type: t("work.companies.baacc.roles.architect.type"),
        location: t("work.companies.baacc.roles.architect.location"),
        achievements: [
          t("work.companies.baacc.roles.architect.achievements.0"),
          t("work.companies.baacc.roles.architect.achievements.1"),
          t("work.companies.baacc.roles.architect.achievements.2"),
          t("work.companies.baacc.roles.architect.achievements.3"),
        ],
        technologies: ["LLM", "MCP", "RAG", "MLOps", "APIs"],
      },
      {
        title: t("work.companies.baacc.roles.fullstack.title"),
        period: t("work.companies.baacc.roles.fullstack.period"),
        duration: t("work.companies.baacc.roles.fullstack.duration"),
        type: t("work.companies.baacc.roles.fullstack.type"),
        location: t("work.companies.baacc.roles.fullstack.location"),
        achievements: [
          t("work.companies.baacc.roles.fullstack.achievements.0"),
          t("work.companies.baacc.roles.fullstack.achievements.1"),
          t("work.companies.baacc.roles.fullstack.achievements.2"),
          t("work.companies.baacc.roles.fullstack.achievements.3"),
        ],
        technologies: [".NET", "Python", "SQL Server", "PostgreSQL", "Android"],
      },
      {
        title: t("work.companies.baacc.roles.junior.title"),
        period: t("work.companies.baacc.roles.junior.period"),
        duration: t("work.companies.baacc.roles.junior.duration"),
        type: t("work.companies.baacc.roles.junior.type"),
        location: t("work.companies.baacc.roles.junior.location"),
        achievements: [
          t("work.companies.baacc.roles.junior.achievements.0"),
          t("work.companies.baacc.roles.junior.achievements.1"),
        ],
        technologies: ["MVC", "SQL Server", "APIs"],
      },
    ],
  },
  {
    id: 2,
    company: t("work.companies.dec.name"),
    totalPeriod: t("work.companies.dec.totalPeriod"),
    totalDuration: t("work.companies.dec.totalDuration"),
    location: t("work.companies.dec.location"),
    workMode: t("work.companies.dec.workMode"),
    logo: "/assets/company/dec.webp",
    roles: [
      {
        title: t("work.companies.dec.roles.webdev.title"),
        period: t("work.companies.dec.roles.webdev.period"),
        duration: t("work.companies.dec.roles.webdev.duration"),
        type: t("work.companies.dec.roles.webdev.type"),
        location: t("work.companies.dec.roles.webdev.location"),
        achievements: [
          t("work.companies.dec.roles.webdev.achievements.0"),
          t("work.companies.dec.roles.webdev.achievements.1"),
          t("work.companies.dec.roles.webdev.achievements.2"),
        ],
        technologies: ["HTML", "CSS", "JavaScript", "WordPress", "Joomla"],
      },
    ],
  },
];
---

<section>
  <!-- Header -->
  <div class="reveal mb-16">
    <span
      class="font-mono text-xs uppercase tracking-widest block mb-3"
      style={`color: var(--color-accent);`}
    >
      // 01. {t("nav.work")}
    </span>
    <h1
      class="text-3xl md:text-5xl font-bold tracking-tight mb-3"
      style={`color: var(--color-text-primary);`}
    >
      {t("work.title")}
    </h1>
    <p class="text-lg" style={`color: var(--color-text-secondary);`}>
      {t("work.subtitle")}
    </p>
  </div>

  <!-- Experience -->
  <div class="space-y-12">
    {
      experiences.map((exp, expIndex) => (
        <div class="reveal" style={`transition-delay: ${expIndex * 0.15}s;`}>
          {/* Company Header */}
          <div class="flex flex-col md:flex-row gap-4 md:gap-5 mb-6">
            <div class="shrink-0">
              {exp.logo ? (
                <div
                  class="w-14 h-14 md:w-16 md:h-16 rounded-xl p-2.5 ring-1"
                  style={`background-color: var(--color-bg-secondary); --tw-ring-color: var(--color-border-default);`}
                >
                  <Image
                    src={exp.logo}
                    alt={`${exp.company} logo`}
                    width={64}
                    height={64}
                    class="w-full h-full object-contain"
                    loading="lazy"
                  />
                </div>
              ) : (
                <div
                  class="w-14 h-14 md:w-16 md:h-16 rounded-xl flex items-center justify-center"
                  style={`background-color: var(--color-accent); color: white;`}
                >
                  <span class="font-bold text-xl">{exp.company.charAt(0)}</span>
                </div>
              )}
            </div>

            <div class="flex-1 min-w-0">
              <h3
                class="text-xl md:text-2xl font-bold"
                style={`color: var(--color-text-primary);`}
              >
                {exp.company}
              </h3>
              <div class="flex flex-wrap gap-2 mt-2">
                <span
                  class="inline-flex items-center gap-1.5 font-mono text-xs uppercase tracking-wider px-2.5 py-1 rounded-md border"
                  style={`background-color: var(--color-bg-tertiary); border-color: var(--color-border-default); color: var(--color-text-tertiary);`}
                >
                  <PiCalendar className="w-3.5 h-3.5" />
                  {exp.totalPeriod}
                </span>
                <span
                  class="inline-flex items-center font-mono text-xs uppercase tracking-wider px-2.5 py-1 rounded-md border"
                  style={`background-color: var(--color-bg-tertiary); border-color: var(--color-border-default); color: var(--color-text-tertiary);`}
                >
                  {exp.totalDuration}
                </span>
                <span
                  class="inline-flex items-center gap-1.5 font-mono text-xs uppercase tracking-wider px-2.5 py-1 rounded-md border"
                  style={`background-color: var(--color-bg-tertiary); border-color: var(--color-border-default); color: var(--color-text-tertiary);`}
                >
                  <PiMapPin className="w-3.5 h-3.5" />
                  {exp.location}
                </span>
                <span
                  class="inline-flex items-center font-mono text-xs uppercase tracking-wider px-2.5 py-1 rounded-md border"
                  style={`background-color: var(--color-accent-muted); border-color: color-mix(in srgb, var(--color-accent) 20%, transparent); color: var(--color-accent);`}
                >
                  {exp.workMode}
                </span>
              </div>
            </div>
          </div>

          {/* Roles Timeline */}
          <div class="space-y-4 ml-1">
            {exp.roles.map((role, roleIndex) => (
              <div
                class="rounded-xl p-5 md:p-6 transition-all duration-300"
                style={`background-color: var(--color-bg-secondary); border: 1px solid var(--color-border-default);`}
                onmouseenter="this.style.borderColor='var(--color-border-hover)'; this.style.boxShadow='0 0 30px -10px var(--color-accent-glow)'"
                onmouseleave="this.style.borderColor='var(--color-border-default)'; this.style.boxShadow='none'"
              >
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2 mb-3">
                  <h4
                    class="text-base md:text-lg font-semibold"
                    style={`color: var(--color-text-primary);`}
                  >
                    {role.title}
                  </h4>
                  <div class="flex flex-wrap gap-2">
                    <span
                      class="inline-flex items-center gap-1.5 font-mono text-xs px-2.5 py-1 rounded-md"
                      style={`background-color: var(--color-bg-tertiary); color: var(--color-text-tertiary);`}
                    >
                      <PiCalendar className="w-3 h-3" />
                      {role.period}
                    </span>
                    <span
                      class="font-mono text-xs px-2.5 py-1 rounded-md"
                      style={`background-color: var(--color-bg-tertiary); color: var(--color-text-tertiary);`}
                    >
                      {role.duration}
                    </span>
                  </div>
                </div>

                <div class="flex flex-wrap gap-2 mb-4">
                  <span
                    class="inline-flex items-center gap-1.5 font-mono text-xs px-2.5 py-1 rounded-md"
                    style={`background-color: var(--color-accent-muted); color: var(--color-accent);`}
                  >
                    <PiBriefcase className="w-3 h-3" />
                    {role.type}
                  </span>
                  <span
                    class="inline-flex items-center gap-1.5 font-mono text-xs px-2.5 py-1 rounded-md border"
                    style={`border-color: var(--color-border-default); color: var(--color-text-tertiary);`}
                  >
                    <PiMapPin className="w-3 h-3" />
                    {role.location}
                  </span>
                </div>

                <div class="grid md:grid-cols-2 gap-5">
                  <div>
                    <div class="flex items-center gap-2 mb-3">
                      <PiLightning className="w-4 h-4 text-emerald-500" />
                      <h5
                        class="text-sm font-semibold"
                        style={`color: var(--color-text-primary);`}
                      >
                        {t("work.labels.highlights")}
                      </h5>
                    </div>
                    <ul class="space-y-2">
                      {role.achievements.map((achievement) => (
                        <li class="flex items-start gap-3">
                          <div class="w-1.5 h-1.5 bg-emerald-500 rounded-full mt-2 shrink-0" />
                          <span
                            class="text-xs md:text-sm leading-relaxed"
                            style={`color: var(--color-text-secondary);`}
                          >
                            {achievement}
                          </span>
                        </li>
                      ))}
                    </ul>
                  </div>

                  <div>
                    <div class="flex items-center gap-2 mb-3">
                      <PiStack
                        className="w-4 h-4"
                        style={{ color: "var(--color-accent)" }}
                      />
                      <h5
                        class="text-sm font-semibold"
                        style={`color: var(--color-text-primary);`}
                      >
                        {t("work.labels.stack")}
                      </h5>
                    </div>
                    <div class="flex flex-wrap gap-2">
                      {role.technologies.map((tech) => (
                        <span
                          class="font-mono text-xs px-2.5 py-1 rounded-md border"
                          style={`background-color: var(--color-bg-tertiary); border-color: var(--color-border-default); color: var(--color-text-secondary);`}
                        >
                          {tech}
                        </span>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
      ))
    }
  </div>
</section>
