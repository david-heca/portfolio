---
import Layout from "@layouts/Layout.astro";
import { useTranslations } from "@i18n/utils";

// Importar componentes de secciones
import Skills from "@sections/Skills.astro";
import Projects from "@sections/Projects.astro";
import Work from "@sections/Work.astro";
import Education from "@sections/Education.astro";
import Contact from "@sections/Contact.astro";
import Home from "@sections/Home.astro";

export async function getStaticPaths() {
  const pages = ["skills", "projects", "work", "education", "contact"];
  const paths: any[] = [];

  // Página principal en inglés
  paths.push({
    params: { slug: "en" },
    props: { page: "home", lang: "en" },
  });

  // Rutas en español
  pages.forEach((page) => {
    paths.push({
      params: { slug: page },
      props: { page, lang: "es" },
    });
  });

  // Rutas en inglés
  pages.forEach((page) => {
    paths.push({
      params: { slug: `en/${page}` },
      props: { page, lang: "en" },
    });
  });

  return paths;
}

const { page, lang } = Astro.props;
const t = useTranslations(lang);

// Configurar metadatos de página
const getPageMeta = (page: string) => {
  if (page === "home") {
    return {
      title: t("meta.home.title"),
      description: t("meta.home.description"),
    };
  }

  const metaKeys: Record<string, string> = {
    skills: "skills",
    projects: "projects",
    work: "work",
    education: "education",
    contact: "contact",
  };

  const key = metaKeys[page];
  if (key) {
    return {
      title: t(`meta.${key}.title`),
      description: t(`meta.${key}.description`),
    };
  }

  return {
    title: t("meta.home.title"),
    description: t("meta.home.description"),
  };
};

const pageMeta = getPageMeta(page);
---

<Layout title={pageMeta.title} description={pageMeta.description} lang={lang}>
  <!-- Renderizar componente -->
  {page === "home" && <Home lang={lang} />}
  {page === "skills" && <Skills lang={lang} />}
  {page === "projects" && <Projects lang={lang} />}
  {page === "work" && <Work lang={lang} />}
  {page === "education" && <Education lang={lang} />}
  {page === "contact" && <Contact lang={lang} />}
</Layout>
